name: Build and Deploy to Cloud Run
on:
  push:
    branches:
      - main
      - build
    paths:
     - 'index.html'
     - 'css/**'
     
# Environment variables available to all jobs and steps in this workflow
env:
    PROJECT_ID: ${{ secrets.PROJECT_ID }}
    DEFAULT_BRANCH: main
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    
jobs:
    setup-build-deploy:
        name: Setup, Build, and Deploy
        runs-on: ubuntu-latest

        steps:
          - id: 'auth'
            uses: 'google-github-actions/auth@v1'
            with:
              service_account_email: ${{ secrets.SA_EMAIL }}
              service_account_key: ${{ secrets.GOOGLE_APPLICATION_CREDENTIALS}}

          - id: 'upload-file'
            uses: 'google-github-actions/upload-cloud-storage@v1'
            with:
              path: '/path/to/file'
              destination: 'desu-project/file'

          # Example of using the output
          - id: 'uploaded-files'
            uses: 'foo/bar@main'
            env:
              file: '${{ steps.upload-file.outputs.uploaded }}'
